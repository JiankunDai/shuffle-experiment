Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
25/12/03 17:57:33 INFO SparkContext: Running Spark version 1.6.3
25/12/03 17:57:33 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/03 17:57:33 WARN SparkConf: In Spark 1.0 and later spark.local.dir will be overridden by the value set by the cluster manager (via SPARK_LOCAL_DIRS in mesos/standalone and LOCAL_DIRS in YARN).
25/12/03 17:57:33 WARN Utils: Your hostname, hygon7490 resolves to a loopback address: 127.0.0.1; using 49.52.27.65 instead (on interface ens2f1np1)
25/12/03 17:57:33 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
25/12/03 17:57:33 INFO SecurityManager: Changing view acls to: djk
25/12/03 17:57:33 INFO SecurityManager: Changing modify acls to: djk
25/12/03 17:57:33 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(djk); users with modify permissions: Set(djk)
25/12/03 17:57:33 INFO Utils: Successfully started service 'sparkDriver' on port 33571.
25/12/03 17:57:34 INFO Slf4jLogger: Slf4jLogger started
25/12/03 17:57:34 INFO Remoting: Starting remoting
25/12/03 17:57:34 INFO Remoting: Remoting started; listening on addresses :[akka.tcp://sparkDriverActorSystem@49.52.27.65:41105]
25/12/03 17:57:34 INFO Utils: Successfully started service 'sparkDriverActorSystem' on port 41105.
25/12/03 17:57:34 INFO SparkEnv: Registering MapOutputTracker
25/12/03 17:57:34 INFO SparkEnv: Registering BlockManagerMaster
25/12/03 17:57:34 INFO DiskBlockManager: Created local directory at /tmp/spark/work/blockmgr-24d15986-e41f-4283-8032-3acec4a799af
25/12/03 17:57:34 INFO MemoryStore: MemoryStore started with capacity 143.3 MB
25/12/03 17:57:34 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/03 17:57:34 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/03 17:57:34 INFO SparkUI: Started SparkUI at http://49.52.27.65:4040
25/12/03 17:57:34 INFO HttpFileServer: HTTP File server directory is /tmp/spark/work/spark-c396a187-e0d8-43c0-9907-749c4a169828/httpd-fa7a7b4a-22ae-4da1-9dd9-9af08a8e2b7c
25/12/03 17:57:34 INFO HttpServer: Starting HTTP Server
25/12/03 17:57:34 INFO Utils: Successfully started service 'HTTP file server' on port 42371.
25/12/03 17:57:34 INFO SparkContext: Added JAR file:/home/djk/Documents/shuffle-experiment/target/scala-2.10/spark-shuffle-experiment-1.0.0.jar at http://49.52.27.65:42371/jars/spark-shuffle-experiment-1.0.0.jar with timestamp 1764784654800
25/12/03 17:57:34 INFO AppClient$ClientEndpoint: Connecting to master spark://49.52.27.113:7077...
25/12/03 17:57:44 INFO SparkDeploySchedulerBackend: Connected to Spark cluster with app ID app-20251203125741-0053
25/12/03 17:57:45 INFO AppClient$ClientEndpoint: Executor added: app-20251203125741-0053/0 on worker-20251203224515-49.52.27.60-35123 (49.52.27.60:35123) with 2 cores
25/12/03 17:57:45 INFO SparkDeploySchedulerBackend: Granted executor ID app-20251203125741-0053/0 on hostPort 49.52.27.60:35123 with 2 cores, 1024.0 MB RAM
25/12/03 17:57:45 INFO AppClient$ClientEndpoint: Executor added: app-20251203125741-0053/1 on worker-20251203144508-49.52.27.65-34725 (49.52.27.65:34725) with 2 cores
25/12/03 17:57:45 INFO SparkDeploySchedulerBackend: Granted executor ID app-20251203125741-0053/1 on hostPort 49.52.27.65:34725 with 2 cores, 1024.0 MB RAM
25/12/03 17:57:45 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 45167.
25/12/03 17:57:45 INFO NettyBlockTransferService: Server created on 45167
25/12/03 17:57:45 INFO BlockManagerMaster: Trying to register BlockManager
25/12/03 17:57:45 INFO BlockManagerMasterEndpoint: Registering block manager 49.52.27.65:45167 with 143.3 MB RAM, BlockManagerId(driver, 49.52.27.65, 45167)
25/12/03 17:57:45 INFO BlockManagerMaster: Registered BlockManager
25/12/03 17:57:45 INFO AppClient$ClientEndpoint: Executor updated: app-20251203125741-0053/1 is now RUNNING
25/12/03 17:57:45 INFO AppClient$ClientEndpoint: Executor updated: app-20251203125741-0053/0 is now RUNNING
25/12/03 17:57:55 INFO EventLoggingListener: Logging events to file:/tmp/spark-events/app-20251203125741-0053
25/12/03 17:57:55 INFO SparkDeploySchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
=== Shuffle File Monitor 实验 ===
3. Spark版本: 1.6.3
默认shuffle分区数: 200
请求的Shuffle Manager: sort
当前 Shuffle Manager: sort
Spark 本地目录: /tmp/spark/work
监控将每秒检查一次 /tmp/spark/work 目录中的 shuffle_* 文件
测试数据集: large
分区数: 200
>>> 正在进行数据预热 (Cache & Count)...
>>> 预热完成! 数据已驻留内存。耗时: 103385ms, 记录数: 5000000
>>> 现在开始正式 Shuffle 实验 (此时文件应该会立即产生)

=== 开始运行 sort 实验 ===
启动Shuffle文件监控，每秒检查一次...
[ShuffleMonitor 17:59:39] 文件数: 210, 总大小: 3KB (峰值: 210文件, 3KB)
[ShuffleMonitor 17:59:40] 文件数: 210, 总大小: 3KB (峰值: 210文件, 3KB)
[ShuffleMonitor 17:59:41] 文件数: 210, 总大小: 3KB (峰值: 210文件, 3KB)
[ShuffleMonitor 17:59:42] 文件数: 214, 总大小: 75.26MB (峰值: 214文件, 75.26MB)
[ShuffleMonitor 17:59:43] 文件数: 214, 总大小: 75.26MB (峰值: 214文件, 75.26MB)
[ShuffleMonitor 17:59:44] 文件数: 218, 总大小: 150.51MB (峰值: 218文件, 150.51MB)
[ShuffleMonitor 17:59:45] 文件数: 218, 总大小: 150.51MB (峰值: 218文件, 150.51MB)
[ShuffleMonitor 17:59:46] 文件数: 222, 总大小: 225.75MB (峰值: 222文件, 225.75MB)
[ShuffleMonitor 17:59:47] 文件数: 222, 总大小: 225.75MB (峰值: 222文件, 225.75MB)
[ShuffleMonitor 17:59:48] 文件数: 226, 总大小: 301.00MB (峰值: 226文件, 301.00MB)
[ShuffleMonitor 17:59:49] 文件数: 228, 总大小: 310.19MB (峰值: 228文件, 310.19MB)
[ShuffleMonitor 17:59:50] 文件数: 230, 总大小: 376.25MB (峰值: 230文件, 376.25MB)
[ShuffleMonitor 17:59:51] 文件数: 232, 总大小: 412.41MB (峰值: 232文件, 412.41MB)
[ShuffleMonitor 17:59:52] 文件数: 234, 总大小: 451.50MB (峰值: 234文件, 451.50MB)
[ShuffleMonitor 17:59:53] 文件数: 237, 总大小: 520.09MB (峰值: 237文件, 520.09MB)
[ShuffleMonitor 17:59:54] 文件数: 238, 总大小: 526.76MB (峰值: 238文件, 526.76MB)
[ShuffleMonitor 17:59:55] 文件数: 241, 总大小: 593.37MB (峰值: 241文件, 593.37MB)
[ShuffleMonitor 17:59:56] 文件数: 242, 总大小: 602.01MB (峰值: 242文件, 602.01MB)
[ShuffleMonitor 17:59:57] 文件数: 246, 总大小: 677.26MB (峰值: 246文件, 677.26MB)
[ShuffleMonitor 17:59:58] 文件数: 246, 总大小: 677.26MB (峰值: 246文件, 677.26MB)
[ShuffleMonitor 17:59:59] 文件数: 250, 总大小: 752.51MB (峰值: 250文件, 752.51MB)
[ShuffleMonitor 18:00:00] 文件数: 250, 总大小: 752.51MB (峰值: 250文件, 752.51MB)
[ShuffleMonitor 18:00:01] 文件数: 254, 总大小: 827.76MB (峰值: 254文件, 827.76MB)
[ShuffleMonitor 18:00:02] 文件数: 254, 总大小: 827.76MB (峰值: 254文件, 827.76MB)
[ShuffleMonitor 18:00:03] 文件数: 258, 总大小: 903.01MB (峰值: 258文件, 903.01MB)
[ShuffleMonitor 18:00:04] 文件数: 259, 总大小: 920.10MB (峰值: 259文件, 920.10MB)
[ShuffleMonitor 18:00:05] 文件数: 262, 总大小: 978.27MB (峰值: 262文件, 978.27MB)
[ShuffleMonitor 18:00:06] 文件数: 264, 总大小: 1007.86MB (峰值: 264文件, 1007.86MB)
[ShuffleMonitor 18:00:07] 文件数: 266, 总大小: 1.03GB (峰值: 266文件, 1.03GB)
[ShuffleMonitor 18:00:08] 文件数: 269, 总大小: 1.09GB (峰值: 269文件, 1.09GB)
[ShuffleMonitor 18:00:09] 文件数: 270, 总大小: 1.10GB (峰值: 270文件, 1.10GB)
[ShuffleMonitor 18:00:10] 文件数: 273, 总大小: 1.17GB (峰值: 273文件, 1.17GB)
[ShuffleMonitor 18:00:11] 文件数: 274, 总大小: 1.18GB (峰值: 274文件, 1.18GB)
[ShuffleMonitor 18:00:12] 文件数: 278, 总大小: 1.25GB (峰值: 278文件, 1.25GB)
[ShuffleMonitor 18:00:13] 文件数: 278, 总大小: 1.25GB (峰值: 278文件, 1.25GB)
[ShuffleMonitor 18:00:14] 文件数: 282, 总大小: 1.32GB (峰值: 282文件, 1.32GB)
[ShuffleMonitor 18:00:15] 文件数: 282, 总大小: 1.32GB (峰值: 282文件, 1.32GB)
[ShuffleMonitor 18:00:16] 文件数: 286, 总大小: 1.40GB (峰值: 286文件, 1.40GB)
[ShuffleMonitor 18:00:17] 文件数: 287, 总大小: 1.40GB (峰值: 287文件, 1.40GB)
[ShuffleMonitor 18:00:18] 文件数: 290, 总大小: 1.47GB (峰值: 290文件, 1.47GB)
[ShuffleMonitor 18:00:19] 文件数: 292, 总大小: 1.50GB (峰值: 292文件, 1.50GB)
[ShuffleMonitor 18:00:20] 文件数: 294, 总大小: 1.54GB (峰值: 294文件, 1.54GB)
[ShuffleMonitor 18:00:21] 文件数: 297, 总大小: 1.60GB (峰值: 297文件, 1.60GB)
[ShuffleMonitor 18:00:22] 文件数: 298, 总大小: 1.62GB (峰值: 298文件, 1.62GB)
[ShuffleMonitor 18:00:23] 文件数: 301, 总大小: 1.69GB (峰值: 301文件, 1.69GB)
[ShuffleMonitor 18:00:24] 文件数: 302, 总大小: 1.69GB (峰值: 302文件, 1.69GB)
[ShuffleMonitor 18:00:25] 文件数: 306, 总大小: 1.76GB (峰值: 306文件, 1.76GB)
[ShuffleMonitor 18:00:27] 文件数: 306, 总大小: 1.76GB (峰值: 306文件, 1.76GB)
[ShuffleMonitor 18:00:28] 文件数: 310, 总大小: 1.84GB (峰值: 310文件, 1.84GB)
[ShuffleMonitor 18:00:29] 文件数: 310, 总大小: 1.84GB (峰值: 310文件, 1.84GB)
[ShuffleMonitor 18:00:30] 文件数: 314, 总大小: 1.91GB (峰值: 314文件, 1.91GB)
[ShuffleMonitor 18:00:31] 文件数: 314, 总大小: 1.91GB (峰值: 314文件, 1.91GB)
[ShuffleMonitor 18:00:32] 文件数: 318, 总大小: 1.98GB (峰值: 318文件, 1.98GB)
[ShuffleMonitor 18:00:33] 文件数: 318, 总大小: 1.98GB (峰值: 318文件, 1.98GB)
[ShuffleMonitor 18:00:34] 文件数: 322, 总大小: 2.06GB (峰值: 322文件, 2.06GB)
[ShuffleMonitor 18:00:35] 文件数: 323, 总大小: 2.06GB (峰值: 323文件, 2.06GB)
[ShuffleMonitor 18:00:36] 文件数: 326, 总大小: 2.13GB (峰值: 326文件, 2.13GB)
[ShuffleMonitor 18:00:37] 文件数: 327, 总大小: 2.14GB (峰值: 327文件, 2.14GB)
[ShuffleMonitor 18:00:38] 文件数: 330, 总大小: 2.20GB (峰值: 330文件, 2.20GB)
[ShuffleMonitor 18:00:39] 文件数: 332, 总大小: 2.25GB (峰值: 332文件, 2.25GB)
[ShuffleMonitor 18:00:40] 文件数: 334, 总大小: 2.28GB (峰值: 334文件, 2.28GB)
[ShuffleMonitor 18:00:41] 文件数: 337, 总大小: 2.33GB (峰值: 337文件, 2.33GB)
[ShuffleMonitor 18:00:42] 文件数: 338, 总大小: 2.35GB (峰值: 338文件, 2.35GB)
[ShuffleMonitor 18:00:43] 文件数: 342, 总大小: 2.43GB (峰值: 342文件, 2.43GB)
[ShuffleMonitor 18:00:44] 文件数: 342, 总大小: 2.43GB (峰值: 342文件, 2.43GB)
[ShuffleMonitor 18:00:45] 文件数: 346, 总大小: 2.50GB (峰值: 346文件, 2.50GB)
[ShuffleMonitor 18:00:46] 文件数: 346, 总大小: 2.50GB (峰值: 346文件, 2.50GB)
[ShuffleMonitor 18:00:47] 文件数: 350, 总大小: 2.57GB (峰值: 350文件, 2.57GB)
[ShuffleMonitor 18:00:48] 文件数: 350, 总大小: 2.57GB (峰值: 350文件, 2.57GB)
[ShuffleMonitor 18:00:49] 文件数: 354, 总大小: 2.65GB (峰值: 354文件, 2.65GB)
[ShuffleMonitor 18:00:50] 文件数: 355, 总大小: 2.65GB (峰值: 355文件, 2.65GB)
[ShuffleMonitor 18:00:51] 文件数: 358, 总大小: 2.72GB (峰值: 358文件, 2.72GB)
[ShuffleMonitor 18:00:52] 文件数: 359, 总大小: 2.73GB (峰值: 359文件, 2.73GB)
[ShuffleMonitor 18:00:53] 文件数: 362, 总大小: 2.79GB (峰值: 362文件, 2.79GB)
[ShuffleMonitor 18:00:54] 文件数: 364, 总大小: 2.84GB (峰值: 364文件, 2.84GB)
[ShuffleMonitor 18:00:55] 文件数: 366, 总大小: 2.87GB (峰值: 366文件, 2.87GB)
[ShuffleMonitor 18:00:56] 文件数: 369, 总大小: 2.92GB (峰值: 369文件, 2.92GB)
[ShuffleMonitor 18:00:57] 文件数: 370, 总大小: 2.94GB (峰值: 370文件, 2.94GB)
[ShuffleMonitor 18:00:58] 文件数: 374, 总大小: 3.01GB (峰值: 374文件, 3.01GB)
[ShuffleMonitor 18:00:59] 文件数: 374, 总大小: 3.01GB (峰值: 374文件, 3.01GB)
[ShuffleMonitor 18:01:00] 文件数: 378, 总大小: 3.09GB (峰值: 378文件, 3.09GB)
[ShuffleMonitor 18:01:01] 文件数: 378, 总大小: 3.09GB (峰值: 378文件, 3.09GB)
[ShuffleMonitor 18:01:02] 文件数: 382, 总大小: 3.16GB (峰值: 382文件, 3.16GB)
[ShuffleMonitor 18:01:03] 文件数: 382, 总大小: 3.16GB (峰值: 382文件, 3.16GB)
[ShuffleMonitor 18:01:04] 文件数: 386, 总大小: 3.23GB (峰值: 386文件, 3.23GB)
[ShuffleMonitor 18:01:05] 文件数: 386, 总大小: 3.23GB (峰值: 386文件, 3.23GB)
[ShuffleMonitor 18:01:06] 文件数: 390, 总大小: 3.31GB (峰值: 390文件, 3.31GB)
[ShuffleMonitor 18:01:07] 文件数: 391, 总大小: 3.31GB (峰值: 391文件, 3.31GB)
[ShuffleMonitor 18:01:08] 文件数: 394, 总大小: 3.38GB (峰值: 394文件, 3.38GB)
[ShuffleMonitor 18:01:09] 文件数: 396, 总大小: 3.41GB (峰值: 396文件, 3.41GB)
[ShuffleMonitor 18:01:10] 文件数: 398, 总大小: 3.45GB (峰值: 398文件, 3.45GB)
[ShuffleMonitor 18:01:11] 文件数: 400, 总大小: 3.50GB (峰值: 400文件, 3.50GB)
[ShuffleMonitor 18:01:12] 文件数: 402, 总大小: 3.53GB (峰值: 402文件, 3.53GB)
[ShuffleMonitor 18:01:13] 文件数: 406, 总大小: 3.60GB (峰值: 406文件, 3.60GB)
[ShuffleMonitor 18:01:14] 文件数: 406, 总大小: 3.60GB (峰值: 406文件, 3.60GB)
[ShuffleMonitor 18:01:15] 文件数: 410, 总大小: 3.67GB (峰值: 410文件, 3.67GB)
[ShuffleMonitor 18:01:16] 文件数: 410, 总大小: 3.67GB (峰值: 410文件, 3.67GB)
[ShuffleMonitor 18:01:17] 文件数: 414, 总大小: 3.75GB (峰值: 414文件, 3.75GB)
[ShuffleMonitor 18:01:18] 文件数: 414, 总大小: 3.75GB (峰值: 414文件, 3.75GB)
[ShuffleMonitor 18:01:19] 文件数: 418, 总大小: 3.82GB (峰值: 418文件, 3.82GB)
[ShuffleMonitor 18:01:20] 文件数: 418, 总大小: 3.82GB (峰值: 418文件, 3.82GB)
[ShuffleMonitor 18:01:21] 文件数: 422, 总大小: 3.89GB (峰值: 422文件, 3.89GB)
[ShuffleMonitor 18:01:22] 文件数: 422, 总大小: 3.89GB (峰值: 422文件, 3.89GB)
[ShuffleMonitor 18:01:23] 文件数: 426, 总大小: 3.97GB (峰值: 426文件, 3.97GB)
[ShuffleMonitor 18:01:24] 文件数: 428, 总大小: 3.99GB (峰值: 428文件, 3.99GB)
[ShuffleMonitor 18:01:25] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:26] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:27] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:28] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:29] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:30] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:31] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:32] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:33] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:34] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:35] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:36] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:37] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:38] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:39] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:40] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:41] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:42] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:43] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:44] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:45] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:46] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:47] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:48] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:49] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:50] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:51] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:52] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:53] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:54] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:55] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:56] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:57] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:58] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:01:59] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:02:00] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:02:01] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:02:02] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:02:03] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)
[ShuffleMonitor 18:02:04] 文件数: 430, 总大小: 4.04GB (峰值: 430文件, 4.04GB)

[ShuffleMonitor 最终报告]
峰值文件数: 430
峰值文件大小: 4.04GB
推测Shuffle类型: Sort Shuffle

==================================================
测试结果 [sort]:
  执行耗时: 140839ms
  Shuffle数据量: 7.35 GB
  峰值Shuffle文件数: 430 个
  峰值Shuffle文件大小: 4238209KB (4138.88MB)
  Shuffle类型分析: 混合/不确定 (430 个文件)
  平均每个文件大小: 9856KB
25/12/03 18:02:05 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from 49.52.27.60/49.52.27.60:52058 is closed
25/12/03 18:02:05 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from 49.52.27.65/49.52.27.65:49794 is closed
java.util.concurrent.RejectedExecutionException: Task scala.concurrent.impl.CallbackRunnable@44c74188 rejected from java.util.concurrent.ThreadPoolExecutor@21bb4ab7[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 24]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:133)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:40)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:248)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:153)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:324)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:324)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32)
	at org.spark-project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:133)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:40)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:248)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:153)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:235)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:235)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32)
	at scala.concurrent.Future$InternalCallbackExecutor$Batch$$anonfun$run$1.processBatch$1(Future.scala:643)
	at scala.concurrent.Future$InternalCallbackExecutor$Batch$$anonfun$run$1.apply$mcV$sp(Future.scala:658)
	at scala.concurrent.Future$InternalCallbackExecutor$Batch$$anonfun$run$1.apply(Future.scala:635)
	at scala.concurrent.Future$InternalCallbackExecutor$Batch$$anonfun$run$1.apply(Future.scala:635)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.Future$InternalCallbackExecutor$Batch.run(Future.scala:634)
	at scala.concurrent.Future$InternalCallbackExecutor$.scala$concurrent$Future$InternalCallbackExecutor$$unbatchedExecute(Future.scala:694)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:685)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:40)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:248)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:153)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:208)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anonfun$2.apply(NettyRpcEnv.scala:230)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anonfun$2.apply(NettyRpcEnv.scala:230)
	at org.apache.spark.rpc.netty.RpcOutboxMessage.onFailure(Outbox.scala:71)
	at org.apache.spark.network.client.TransportResponseHandler.failOutstandingRequests(TransportResponseHandler.java:110)
	at org.apache.spark.network.client.TransportResponseHandler.channelUnregistered(TransportResponseHandler.java:124)
	at org.apache.spark.network.server.TransportChannelHandler.channelUnregistered(TransportChannelHandler.java:94)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelUnregistered(AbstractChannelHandlerContext.java:158)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelUnregistered(AbstractChannelHandlerContext.java:144)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelUnregistered(ChannelInboundHandlerAdapter.java:53)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelUnregistered(AbstractChannelHandlerContext.java:158)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelUnregistered(AbstractChannelHandlerContext.java:144)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelUnregistered(ChannelInboundHandlerAdapter.java:53)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelUnregistered(AbstractChannelHandlerContext.java:158)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelUnregistered(AbstractChannelHandlerContext.java:144)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelUnregistered(ChannelInboundHandlerAdapter.java:53)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelUnregistered(AbstractChannelHandlerContext.java:158)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelUnregistered(AbstractChannelHandlerContext.java:144)
	at io.netty.channel.DefaultChannelPipeline.fireChannelUnregistered(DefaultChannelPipeline.java:739)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$8.run(AbstractChannel.java:659)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:328)
	at io.netty.util.concurrent.SingleThreadEventExecutor.confirmShutdown(SingleThreadEventExecutor.java:627)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:362)
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)
	at java.lang.Thread.run(Thread.java:750)
